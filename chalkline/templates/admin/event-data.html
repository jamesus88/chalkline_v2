<head>
    <link rel="stylesheet" href="{{url_for('static', filename='schedule.css')}}">
    <script src="{{url_for('static', filename='schedule.js')}}" defer></script>
    <style>
        @media screen and (max-width: 2000px) {
            main {
                width: 95%;
            }
        }
    </style>
</head>

{% extends "design.html" %}
{% block title %}Admin{% endblock title %}

{% block content %}
<main>
    <section class="split">
        <div>
            <h1>Events ({{league.current_season}})</h1>
            <p class="error">{{res.msg}}</p>
        </div>
        <div class="align-right">
            <h3><a href="{{url_for('admin.add_event')}}">Add Event</a></h3>
        </div>
    </section>

    <button type="" onclick="toggleFilterSection('filter-section')" class="filter-dropdown action"><i class="fa-solid fa-filter"></i> Filters</button>
    <form method="post">
        <section id="filter-section" class="filter-section">
        </section>

        <section class="split">
            <div>
            </div>
            <div class="align-right">
                <button type="submit" class="action" name="save" value="save"><i class="fa-solid fa-floppy-disk"></i> Save</button>
            </div>
        </section>

        <section class="schedule-section scrollwrapper">
            {% if events|length < 1 %}
            <h3 class="error">No events found.</h3>
            {% endif %}
            <table id="schedule-table" class="event-display admin">
                <tr>
                    <th></th>
                    <th>Event</th>
                    <th>Date/Time</th>
                    <th>Venue</th>
                    <th>Field</th>
                    <th>Age Group</th>
                    <th>Status</th>
                    <th>Away</th>
                    <th>Home</th>
                    <th>Delete</th>
                </tr>
                {% for e in events %}
                <tr class="event-row">
                    <td><a class="icon-link" href="{{url_for('view_info.event', eventId=e._id)}}"><i class="fa-solid fa-info"></i></a></td>
                    <td class="event-type">{{e.type}}</td>
                    <td><input class="admin" type="datetime-local" name="{{e._id}}_date" id="date" value="{{e.date.isoformat()}}"></td>
                    <td><select class="admin" name="{{e._id}}_venueId" id="{{e._id}}_venueId">
                        {% for v in league.venues %}
                            <option value="{{v}}">{{v}}</option>
                        {% endfor %}
                    </select></td>
                    <td><input class="admin" type="number" name="{{e._id}}_field" id="field" value="{{e.field}}"></td>
                    <td><select class="admin" name="{{e._id}}_age" id="{{e._id}}_age">
                        {% for a in league.age_groups %}
                            <option value="{{a}}">{{a}}</option>
                        {% endfor %}
                    </select></td>
                    <td><input class="admin" type="text" name="{{e._id}}_status" id="status" value="{{e.status}}"></td>
                    <td><select class="admin" name="{{e._id}}_away" id="{{e._id}}_away">
                        <option value="None">None</option> 
                        {% for t in league.teams %}
                            <option value="{{t.teamId}}">{{t.teamId}}</option>
                        {% endfor %}
                    </select></td>
                    <td><select class="admin" name="{{e._id}}_home" id="{{e._id}}_home">
                        <option value="None">None</option> 
                        {% for t in league.teams %}
                            <option value="{{t.teamId}}">{{t.teamId}}</option>
                        {% endfor %}
                    </select></td>
                    <td><button class="schedule-action danger" type="submit" name="delete" value="{{e._id}}" onclick="return confirm('Delete event?')">Delete</button></td>
                </tr>
                <script>
                    document.getElementById("{{e._id}}"+"_away").value = "{{e.away}}";
                    document.getElementById("{{e._id}}"+"_home").value = "{{e.home}}";
                    document.getElementById("{{e._id}}"+"_venueId").value = "{{e.venueId}}";
                    document.getElementById("{{e._id}}"+"_age").value = "{{e.age}}";
                </script>
                {% endfor %}
            </table>
        </section>
        <button id="load-more" type="button" class="action" onclick="load()">Load More</button>
    </form>
</main>

{% endblock content %}